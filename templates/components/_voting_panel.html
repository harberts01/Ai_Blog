{# Reusable voting panel â€” included by comparison.html for both premium and bootstrap-free users #}
<div class="voting-panel {% if not has_voted %}gated{% endif %}" id="voting-panel">
  <div class="gate-message" id="gate-message">
    <div class="gate-timer-ring" id="gate-timer-ring">
      <svg viewBox="0 0 36 36" class="gate-timer-svg">
        <path class="gate-timer-bg"
          d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
          fill="none" stroke-width="3" />
        <path class="gate-timer-fill" id="gate-timer-fill"
          d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"
          fill="none" stroke-width="3" stroke-dasharray="0, 100" />
      </svg>
      <span class="gate-timer-text" id="gate-timer-text">30</span>
    </div>
    <div class="gate-label">Read both posts to unlock voting</div>
  </div>

  {% if has_voted and not votes_locked %}
  <div class="text-center mb-2">
    <span class="badge bg-warning text-dark countdown-badge" id="edit-countdown"></span>
  </div>
  {% endif %}

  <div class="vote-categories" id="vote-categories">
    {% set cat_descriptions = {
      'writing_quality': 'Grammar, flow, and readability',
      'accuracy': 'Factual correctness and depth',
      'creativity': 'Originality and unique angles',
      'usefulness': 'Practical value and actionable insights',
      'overall': 'Your holistic preference'
    } %}
    {% for cat in vote_categories %}
    <div class="vote-card" data-category="{{ cat }}">
      <h6>{{ cat.replace('_', ' ').title() }}</h6>
      <div class="vote-desc">{{ cat_descriptions[cat] }}</div>
      <div class="d-flex gap-1 justify-content-center">
        <button class="vote-btn" data-winner="left"
          onclick="selectVote('{{ cat }}', 'left', this)">Post A</button>
        <button class="vote-btn" data-winner="right"
          onclick="selectVote('{{ cat }}', 'right', this)">Post B</button>
      </div>
      <!-- Results overlay (hidden until reveal) -->
      <div class="result-display mt-2" style="display:none;">
        <div class="result-bar-wrap">
          <div class="result-bar-a" id="bar-a-{{ cat }}" style="width:0%"></div>
          <div class="result-bar-b" id="bar-b-{{ cat }}" style="width:0%"></div>
        </div>
        <div class="d-flex justify-content-between small">
          <span id="pct-a-{{ cat }}"></span>
          <span id="pct-b-{{ cat }}"></span>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>

  <!-- Submit Button (inline, no separate bar) -->
  <div class="text-center mt-3" id="submit-bar" {% if has_voted and votes_locked %}style="display:none;"{% endif %}>
    <button class="submit-btn-main {% if has_voted and not votes_locked %}update-mode{% endif %}" id="submit-btn" disabled onclick="submitVotes()">
      <i class="bi bi-send-fill" id="submit-icon"></i>
      <span id="submit-text">Submit Votes (0 of 5)</span>
      <span id="submit-spinner" class="spinner-border spinner-border-sm" style="display:none;" role="status"></span>
    </button>
    <div id="vote-error" class="alert alert-danger mt-2 mx-auto text-center small" style="display:none; max-width: 500px;" role="alert"></div>
  </div>
</div>
