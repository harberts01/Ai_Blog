{# Reusable voting panel â€” included by comparison.html for both premium and bootstrap-free users #}
<div class="voting-panel {% if not has_voted %}gated{% endif %}" id="voting-panel">
  <div class="gate-message" id="gate-message">
    <i class="bi bi-book me-1"></i> Read both posts before voting.
  </div>

  {% if has_voted and not votes_locked %}
  <div class="text-center mb-2">
    <span class="badge bg-warning text-dark countdown-badge" id="edit-countdown"></span>
  </div>
  {% endif %}

  <div class="vote-categories" id="vote-categories">
    {% set cat_descriptions = {
      'writing_quality': 'Grammar, flow, and readability',
      'accuracy': 'Factual correctness and depth',
      'creativity': 'Originality and unique angles',
      'usefulness': 'Practical value and actionable insights',
      'overall': 'Your holistic preference'
    } %}
    {% for cat in vote_categories %}
    <div class="vote-card" data-category="{{ cat }}">
      <h6>{{ cat.replace('_', ' ').title() }}</h6>
      <div class="vote-desc">{{ cat_descriptions[cat] }}</div>
      <div class="d-flex gap-1 justify-content-center">
        <button class="vote-btn" data-winner="left"
          onclick="selectVote('{{ cat }}', 'left', this)">Post A</button>
        <button class="vote-btn" data-winner="right"
          onclick="selectVote('{{ cat }}', 'right', this)">Post B</button>
      </div>
      <!-- Results overlay (hidden until reveal) -->
      <div class="result-display mt-2" style="display:none;">
        <div class="result-bar-wrap">
          <div class="result-bar-a" id="bar-a-{{ cat }}" style="width:0%"></div>
          <div class="result-bar-b" id="bar-b-{{ cat }}" style="width:0%"></div>
        </div>
        <div class="d-flex justify-content-between small">
          <span id="pct-a-{{ cat }}"></span>
          <span id="pct-b-{{ cat }}"></span>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
</div>

<!-- Submit Bar -->
<div class="submit-bar" id="submit-bar" {% if has_voted and votes_locked %}style="display:none;"{% endif %}>
  <div class="d-flex justify-content-center align-items-center gap-3">
    <button class="btn btn-primary px-4" id="submit-btn" disabled onclick="submitVotes()">
      <span id="submit-text">Submit Votes (0 of 5)</span>
      <span id="submit-spinner" class="spinner-border spinner-border-sm ms-1" style="display:none;" role="status"></span>
    </button>
  </div>
  <div id="vote-error" class="alert alert-danger mt-2 mx-auto text-center small" style="display:none; max-width: 500px;" role="alert"></div>
</div>
